<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>成为ob贡献者(6):如何阅读Paxos代码 - Troy的网络博客</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Troy" /><meta name="description" content="自我驱动学习，专业上只能靠自己" /><meta name="keywords" content="daily-interview-question, Github, c&#43;&#43;, Leetcode 题解, 后端面试" />






<meta name="generator" content="Hugo 0.83.1 with theme even" />


<link rel="canonical" href="https://wangcy6.github.io/post/oceanbase/2024/day11_make_ob-1/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="成为ob贡献者(6):如何阅读Paxos代码" />
<meta property="og:description" content="自我驱动学习，专业上只能靠自己" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wangcy6.github.io/post/oceanbase/2024/day11_make_ob-1/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-10-04T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2024-10-04T00:00:00&#43;00:00" />

<meta itemprop="name" content="成为ob贡献者(6):如何阅读Paxos代码">
<meta itemprop="description" content="自我驱动学习，专业上只能靠自己"><meta itemprop="datePublished" content="2024-10-04T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2024-10-04T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="4280">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="成为ob贡献者(6):如何阅读Paxos代码"/>
<meta name="twitter:description" content="自我驱动学习，专业上只能靠自己"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Even</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="https://github.com/wangcy6/weekly/tree/master/book">
        <li class="mobile-menu-item">阅读清单</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于我</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Even</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://github.com/wangcy6/weekly/tree/master/book">阅读清单</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于我</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">成为ob贡献者(6):如何阅读Paxos代码</h1>

      <div class="post-meta">
        <span class="post-time"> 2024-10-04 00:00 </span>
        <div class="post-category">
            <a href="/categories/oceanbase/"> oceanbase </a>
            </div>
          <span class="more-meta"> 约 4280 字 </span>
          <span class="more-meta"> 预计阅读 9 分钟 </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#了解需求-编译器-连接器-标准库区别">了解需求： 编译器 连接器 标准库区别</a></li>
  </ul>

  <ul>
    <li><a href="#任务01-从hello-word">任务01: 从hello word</a></li>
    <li><a href="#gcc-编译-hello-world代码过程">gcc 编译 hello world代码过程</a></li>
    <li><a href="#clang-编译hellow-word-过程">clang 编译hellow word 过程</a>
      <ul>
        <li><a href="#这样做的效果">这样做的效果：</a></li>
      </ul>
    </li>
    <li><a href="#任务拆封02-posix-aio-asynchronous-io-on-macos">任务拆封02: POSIX AIO (Asynchronous I/O)** on macOS</a>
      <ul>
        <li><a href="#task03-源码分析-buildsh执行过程">task03 源码分析 build.sh执行过程</a></li>
        <li><a href="#1系统要求">1. 系统要求</a></li>
        <li><a href="#2-基础编译工具">2. 基础编译工具</a></li>
        <li><a href="#3编译器版本要求">3. 编译器版本要求</a></li>
        <li><a href="#4-系统资源要求">4. 系统资源要求</a></li>
        <li><a href="#5-依赖库要求">5. 依赖库要求</a></li>
        <li><a href="#6-cmake要求">6. CMake要求</a></li>
        <li><a href="#流程说明">流程说明：</a></li>
        <li><a href="#macos改造方案">MacOS改造方案</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#参考">参考</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>为了整理思路，文章采用模拟2人对话方式。
本文主要内容</p>
<ol>
<li>libc++ 是LLVM编译器套件的默认C++标准库。</li>
<li>libstdc++是GNU编译器套件（GCC）的默认C++标准库</li>
<li>clang 环境变量设置</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&#34;/usr/local/opt/llvm/bin:</span><span class="nv">$PATH</span><span class="s2">&#34;</span>
<span class="nb">export</span> <span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">&#34;-L/usr/local/opt/llvm/lib/c++ -L/usr/local/opt/llvm/lib/unwind -lunwind&#34;</span> 
<span class="nb">export</span> <span class="nv">CPPFLAGS</span><span class="o">=</span><span class="s2">&#34;-I/usr/local/opt/llvm/include“
</span></code></pre></td></tr></table>
</div>
</div><p>[compilation SIG] 编译和兼容</p>
<h2 id="了解需求-编译器-连接器-标准库区别">了解需求： 编译器 连接器 标准库区别</h2>
<p><a href="https://oceanbase.github.io/oceanbase/toolchain/">https://oceanbase.github.io/oceanbase/toolchain/</a></p>
<table>
<thead>
<tr>
<th style="text-align:left">操作系统</th>
<th style="text-align:left">开发语言</th>
<th style="text-align:left">编译器</th>
<th>连接器</th>
<th>c++标准库</th>
<th>集成工具</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Linux</td>
<td style="text-align:left">c/c++</td>
<td style="text-align:left"><strong>GCC</strong></td>
<td>GNU Linker (ld)</td>
<td>libstdc++</td>
<td>gcc/g++</td>
</tr>
<tr>
<td style="text-align:left">macOS</td>
<td style="text-align:left">c/c++</td>
<td style="text-align:left"><strong>Clang</strong></td>
<td>LLVM Linker (lld)</td>
<td>libc++</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">Windows</td>
<td style="text-align:left">c++</td>
<td style="text-align:left">MSVC</td>
<td>link.exe</td>
<td></td>
<td>Microsoft Visual C++/MinGW</td>
</tr>
<tr>
<td style="text-align:left">跨平台</td>
<td style="text-align:left">Go</td>
<td style="text-align:left">gc</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">跨平台</td>
<td style="text-align:left">rust</td>
<td style="text-align:left">rustc</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>理清gcc、 g++,clang, libc,libc++,libstdc++的关系</p>
<p>提问：gcc是编译c语言代码，g++编译cpp代码，有什么区别 或者说c与cpp有什么区别？</p>
<ul>
<li>差别 就是标准库，例如 stl 用到数据结构和算法</li>
</ul>
<p>gcc hello.cpp  -lstdc++</p>
<p>如果想使用 <code>gcc</code> 指令来编译执行 <code>C++</code> 程序，需要在使用 <code>gcc</code> 指令时，手动为其添加 <code>-lstdc++</code> 选项，表示 <code>gcc</code> 在编译 <code>C++</code> 程序时可以链接必要的 <code>C++</code> 标准库</p>
<p>该程序中使用了标准库 <code>&lt;iostream&gt;</code> 和 <code>&lt;string&gt;</code> 提供的类对象，而 <code>gcc</code> 默认是无法找到它们的</p>
<p>提问：标准库：libc ，libc++， libstdc++区别？</p>
<ol>
<li>编译器支持：
libstdc++是GNU编译器套件（GCC）的默认C++标准库实现，
而libc++是LLVM编译器套件的默认C++标准库实现。
因此，libstdc++主要用于GCC编译器，而libc++主要用于LLVM编译器（如Clang）。</li>
</ol>
<ul>
<li>gcc:/usr/lib/gcc/x86_64-linux-gnu/11/libstdc++.so</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">ldd a.out 
        libstdc++.so.6 =&gt; /lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f62cd56f000) c++
        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f62cd346000) c
</code></pre></td></tr></table>
</div>
</div><ol>
<li>标准遵循：libstdc++实现了C++98、C++03、C++11、C++14和C++17标准的大部分功能，而libc++更加注重C++11、C++14和C++17标准的支持，并且在C++20标准中有更好的兼容性。
libc++ is a new implementation of the C++ standard library, targeting C++11 and above.</li>
</ol>
<h1 id="开发过程">开发过程</h1>
<h2 id="任务01-从hello-word">任务01: 从hello word</h2>
<p>mac 使用Clang配置VS Code C/C++环境</p>
<p>mac 版本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sw_vers

ProductName: macOS

ProductVersion: 15.2

BuildVersion: 24C101

问题：
Warning: You are using macOS 12.  
We <span class="o">(</span>and Apple<span class="o">)</span> <span class="k">do</span> not provide support <span class="k">for</span> this old version.
但在今年9月份的一次更新中，Brew 放弃了对 Monterey 的支持
解决：
升级os版本 耗时一个晚上

</code></pre></td></tr></table>
</div>
</div><p>installing LLVM on MacOS</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">xcode-select --install //大约15分钟
xcode-select -p

/Applications/Xcode.app/Contents/Developer

brew update
xcode-select --install //大约15分钟
brew install llvm //
</code></pre></td></tr></table>
</div>
</div><p>查看帮助文档:brew info llvm</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">==&gt; llvm: stable 19.1.6 (bottled), HEAD [keg-only]

Next-gen compiler infrastructure

https://llvm.org/

Installed

/usr/local/Cellar/llvm/19.1.6 (8,107 files, 2GB)

Poured from bottle using the formulae.brew.sh API on 2025-01-12 at 08:26:07

From: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/l/llvm.rb

License: Apache-2.0 WITH LLVM-exception

==&gt; Dependencies

Build: cmake, ninja, swig

Required: python@3.13, xz, z3, zstd

==&gt; Options

--HEAD

Install HEAD version

==&gt; Caveats

CLANG_CONFIG_FILE_SYSTEM_DIR: /usr/local/etc/clang

CLANG_CONFIG_FILE_USER_DIR: ~/.config/clang

  

LLD is now provided in a separate formula:

brew install lld


We plan to build LLVM 20 with `LLVM_ENABLE_EH=OFF`. Please see:

https://github.com/orgs/Homebrew/discussions/5654


Using `clang`, `clang++`, etc., requires a CLT installation at `/Library/Developer/CommandLineTools`.

If you don&#39;t want to install the CLT, you can write appropriate configuration files pointing to your

SDK at ~/.config/clang.

  

To use the bundled libunwind please use the following LDFLAGS:

LDFLAGS=&#34;-L/usr/local/opt/llvm/lib/unwind -lunwind&#34;

  

To use the bundled libc++ please use the following LDFLAGS:

LDFLAGS=&#34;-L/usr/local/opt/llvm/lib/c++ -L/usr/local/opt/llvm/lib/unwind -lunwind&#34;

  

NOTE: You probably want to use the libunwind and libc++ provided by macOS unless you know what you&#39;re doing.

  

llvm is keg-only, which means it was not symlinked into /usr/local,

because macOS already provides this software and installing another version in

parallel can cause all kinds of trouble.

  

If you need to have llvm first in your PATH, run:

echo &#39;export PATH=&#34;/usr/local/opt/llvm/bin:$PATH&#34;&#39; &gt;&gt; ~/.zshrc

  

For compilers to find llvm you may need to set:

export LDFLAGS=&#34;-L/usr/local/opt/llvm/lib&#34;

export CPPFLAGS=&#34;-I/usr/local/opt/llvm/include&#34;
</code></pre></td></tr></table>
</div>
</div><p>编译环境配置：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">echo &#39;export PATH=&#34;/usr/local/opt/llvm/bin:$PATH&#34;&#39; &gt;&gt; ~/.bashrc

//这将使你的终端会话能够找到 LLVM 的 `clang` 和 `clang++` 命令。

clang -v

Homebrew clang version 19.1.6

Target: x86_64-apple-darwin24.2.0

Thread model: posix

InstalledDir: /usr/local/Cellar/llvm/19.1.6/bin

Configuration file: /usr/local/etc/clang/x86_64-apple-darwin24.cfg

System configuration file directory: /usr/local/etc/clang


设置编译器标志
To use the bundled libc++ please use the following LDFLAGS:
echo &#39;export LDFLAGS=&#34;-L/usr/local/opt/llvm/lib - L/usr/local/opt/llvm/lib/c++ -L/usr/local/opt/llvm/lib/unwind -lunwind&#34;&#39; &gt;&gt; ~/.bashrc
echo &#39;export CPPFLAGS=&#34;-I/usr/local/opt/llvm/include&#34;&#39; &gt;&gt; ~/.bashrc
source ~/.bashrc

</code></pre></td></tr></table>
</div>
</div><p>How to use LDFLAGS in makefile</p>
<p>Makefile选项CPPFLAGS ：</p>
<ul>
<li>指定头文件（.h文件）的路径</li>
<li>CPPFLAGS 可以 用于 C 和 C++ 两者。</li>
<li>gcc参数 -I/usr/include ，大写的I</li>
</ul>
<p>Makefile选项LDFLAGS</p>
<ul>
<li>指定库文件的位置</li>
<li>gcc参数LDFLAGS=-L/usr/lib 大写L</li>
<li><strong>LIBS</strong>：告诉链接器要链接哪些库文件，如LIBS = -lpthread -liconv 小写l</li>
</ul>
<h2 id="gcc-编译-hello-world代码过程">gcc 编译 hello world代码过程</h2>
<p><img src="https://www.ink-hz.cn/2021/10/10/computer-system/gcc-compile/The-Compile-System.png" alt="gcc的编译过程">
说明：</p>
<p>GCC程序的编译过程大概分四个阶段</p>
<ul>
<li>
<p>预处理（Pre-Processing）
g++ -E hello.cpp -o  hello.i
说明：</p>
<ol>
<li>g++ 默认使用 libstdc++标准库</li>
<li>模板的处理不是在<strong>预处理阶段</strong>完成的</li>
</ol>
</li>
<li>
<p>编译（Compiling）：</p>
<ol>
<li>g++ -S hello.i -o hello.s</li>
<li>说明：编译过程就是把预处理完的文件进行一系列词法分析，语法分析，语义分析及优化后生成相应的汇编代码文件</li>
</ol>
</li>
<li>
<p>汇编（Assembling）
1.g++ -c  hello.s  -o hello.o
2. objdump  -h hello.o以获取二进制文件每个段的头部信息</p>
</li>
<li>
<p>链接（Linking）</p>
</li>
</ul>
<ol>
<li>链接器ld将各个目标文件组装在一起，解决符号依赖，库依赖关系，并生成可执行文件</li>
<li>g++ -o hello hello.o</li>
<li>连接过程 g++ -v -o hello hello.o</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">Using built-in specs.
COLLECT_GCC=g++
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/11/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none:amdgcn-amdhsa
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-linux-gnx
Thread model: posix


</code></pre></td></tr></table>
</div>
</div><p>默认情况下是使用动态链接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">file hello
hello: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked
</code></pre></td></tr></table>
</div>
</div><h2 id="clang-编译hellow-word-过程">clang 编译hellow word 过程</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">clang++ hello.cpp -o hello -L/usr/local/opt/llvm/lib/c++ -L/usr/local/opt/llvm/lib/unwind -lc++ -lunwind


export LDFLAGS=&#34;-L/usr/local/opt/llvm/lib/c++ -L/usr/local/opt/llvm/lib/unwind -lunwind&#34;

clang++ hello.cpp -o hello


otool -L hello
/usr/lib/libc++.1.dylib (compatibility version 1.0.0, current version 1800.105.0)

/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1351.0.0)
</code></pre></td></tr></table>
</div>
</div><ul>
<li><strong><code>lang++</code></strong>：使用 LLVM 的 C++ 编译器来编译 C++ 源代码。</li>
<li><strong><code>hello.cpp</code></strong>：你的 C++ 源文件。</li>
<li><strong><code>-o hello</code></strong>：指定输出文件名为 <code>hello</code>，即编译后生成的可执行文件名。</li>
<li><strong><code>-L/usr/local/opt/llvm/lib/c++</code></strong>：告诉编译器去 <code>/usr/local/opt/llvm/lib/c++</code> 目录查找 <code>libc++</code> 库，这是通过 Homebrew 安装的 LLVM 提供的库。</li>
<li><strong><code>-L/usr/local/opt/llvm/lib/unwind</code></strong>：告诉编译器去 <code>/usr/local/opt/llvm/lib/unwind</code> 目录查找 <code>libunwind</code> 库，这是 LLVM 提供的用于处理堆栈展开和异常的库。</li>
<li><strong><code>-lc++</code></strong>：指定使用 LLVM 提供的 <code>libc++</code> 库。</li>
<li><strong><code>-lunwind</code></strong>：指定链接 LLVM 提供的 <code>libunwind</code> 库</li>
</ul>
<h3 id="这样做的效果">这样做的效果：</h3>
<ul>
<li>通过这个命令，<code>clang++</code> 将使用 Homebrew 安装的 LLVM 提供的 <code>libc++</code> 和 <code>libunwind</code>，而不是系统自带的版本。</li>
<li>这对于需要使用更现代的 LLVM 特性或者自定义版本的库时非常有用</li>
</ul>
<p>小王提问：/usr/lib/libc++.1.dylib  是 macOS 系统自带的** C++ 标准库，不是通过 LLVM 安装的。这个编译不对</p>
<p>老王回答:~/.bash_profile环境变量重新设置一次</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">export LDFLAGS=&#34;-L/usr/local/opt/llvm/lib/c++ -L/usr/local/opt/llvm/lib/unwind -lunwind&#34; 

export CPPFLAGS=&#34;-I/usr/local/opt/llvm/include“

clang++ hello.cpp -o hello

otool -L hello
hello:
/usr/local/opt/llvm/lib/c++/libc++.1.dylib (compatibility version 1.0.0, current version 1.0.0)

/usr/local/opt/llvm/lib/unwind/libunwind.1.dylib (compatibility version 1.0.0, current version 1.0.0)


</code></pre></td></tr></table>
</div>
</div><p>完整过程：clang++ -v  hello.cpp -o hello</p>
<p>clang++ -v -E  hello.cpp -o hello.i
 clang++ -v -c  hello.s -o hello.o
clang++  -v  hello.o -o hello
从你提供的 <code>clang++ -v hello.cpp -o hello</code> 命令的输出中，我们可以看到 <code>clang++</code> 编译过程的详细信息，涉及几个关键步骤：</p>
<ol>
<li>
<p><strong>编译器信息</strong>：</p>
<ul>
<li><strong><code>clang version 19.1.6</code></strong>：表示你正在使用 Homebrew 安装的 <code>clang++</code> 版本 19.1.6。</li>
<li><strong>目标平台</strong>：<code>x86_64-apple-darwin24.2.0</code>，表明编译器为 macOS 的 x86_64 架构生成代码。</li>
<li><strong>安装目录</strong>：编译器位于 <code>/usr/local/Cellar/llvm/19.1.6/bin</code>。</li>
</ul>
</li>
<li>
<p><strong>预处理</strong>：</p>
<ul>
<li>编译器会处理源代码文件 <code>hello.cpp</code>，展开其中的宏和头文件。编译器在日志中显示了头文件搜索路径。例如，它会查找 <code>#include</code> 文件，在 <code>/usr/local/Cellar/llvm/19.1.6/bin/../include/c++/v1</code> 和 <code>/usr/local/Cellar/llvm/19.1.6/lib/clang/19/include</code> 等目录中查找标准库。</li>
</ul>
</li>
<li>
<p><strong>编译</strong>：</p>
<ul>
<li>在此阶段，<code>clang++</code> 将 C++ 源代码文件 <code>hello.cpp</code> 编译为目标文件（<code>.o</code> 文件）。它调用了 <code>clang-19</code>（<code>clang++</code> 的前端），并且使用了很多编译选项，如 <code>-target-sdk-version=15.2</code> 来指定 SDK 版本。</li>
<li>日志中提到了编译器的一些标志，如 <code>-fcxx-exceptions</code>（启用 C++ 异常支持），<code>-fexceptions</code>（启用异常），<code>-mrelocation-model pic</code>（生成位置无关代码），等等。</li>
</ul>
</li>
<li>
<p><strong>链接</strong>：</p>
<ul>
<li>最后，编译器调用 <code>ld</code>（链接器）来链接生成目标文件（<code>.o</code>）和所需的标准库（如 <code>libc++</code>）。这会生成最终的可执行文件 <code>hello</code>。</li>
<li>链接器调用日志显示了它如何将目标文件与标准库链接（包括 <code>libc++</code> 和 <code>libSystem</code>），并使用 <code>-syslibroot</code> 指定了 macOS 的系统库路径。</li>
</ul>
</li>
</ol>
<h2 id="任务拆封02-posix-aio-asynchronous-io-on-macos">任务拆封02: POSIX AIO (Asynchronous I/O)** on macOS</h2>
<p>我昨天又看了一下，大致有posix aio替换libaio，mac llvm原生编译依赖（clang 17或者19），mac llvm原生编译observer（这个有些基础了，但c++标准库要从libstdc++替换到libc++）</p>
<p>I/O多路复用方案</p>
<ul>
<li>macOS  kqueue</li>
<li>POSIX AIO</li>
<li>Linux libAIO</li>
</ul>
<p>![[Pasted image 20250112125303.png]]</p>
<p>小王提问：Difference between POSIX AIO and libaio on Linux?</p>
<p>POSIX AIO 本质上在是在用户级别上实现的，它在多个线程中执行正常的阻塞 I/O，不需要内核支持，因此给人一种 I/O 是异步的错觉。这样做特点是：
▶ 它适用于任何文件系统
▶ 它（基本上）可以在任何操作系统上运行
▶ 它适用于启用缓冲的文件（即不设置 O_DIRECT 标志）
而主要缺点是IO队列深度（即实际可以执行的未完成操作数）受所选线程数的限制</p>
<p>The POSIX AIO is a user-level implementation that performs normal blocking I/O in multiple threads, hence giving the illusion that the I/Os are asynchronous. The main reason to do this is that:</p>
<ol>
<li>it works with any filesystem</li>
<li>it works (essentially) on any operating system (keep in mind that gnu&rsquo;s libc is portable)</li>
<li>it works on files with buffering enabled (i.e. no O_DIRECT flag set)</li>
</ol>
<p><strong>linux AIO — libaio 实现的异步 IO</strong></p>
<p>The Linux-native asynchronous I/O facility (&ldquo;async I/O&rdquo;, or &ldquo;aio&rdquo;) has a richer API and capability set than the simple POSIX async I/O facility
linux AIO 则是 linux 内核原声支持的异步 IO 调用，行为更加低级。</p>
<p><code>io_uring</code> 是 2019 年 <strong>==Linux 5.1==</strong> 内核首次引入的高性能 <strong>==异步 I/O 框架==</strong>，能显著加速 I/O 密集型应用的性能</p>
<p>关于 linux IO 模型及 AIO、POSIX AIO 的简
<a href="https://cloud.tencent.com/developer/article/2031221">https://cloud.tencent.com/developer/article/2031221</a>
<a href="https://formulae.brew.sh/formula/libaio">https://formulae.brew.sh/formula/libaio</a></p>
<p>[译] Linux 异步 I/O 框架 io_uring：基本原理、程序示例与性能压测（2020
<a href="https://arthurchiao.art/blog/intro-to-io-uring-zh/">https://arthurchiao.art/blog/intro-to-io-uring-zh/</a></p>
<blockquote>
<p><strong>POSIX AIO (Asynchronous I/O)</strong> on macOS</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-c++" data-lang="c++">
<span class="n">clang</span> <span class="o">-</span><span class="n">v</span>
<span class="n">Homebrew</span> <span class="n">clang</span> <span class="n">version</span> <span class="mf">19.1.6</span>

<span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="err">@</span><span class="n">github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">watchpoints</span><span class="o">/</span><span class="n">oceanbase</span><span class="p">.</span><span class="n">git</span>


<span class="n">brew</span> <span class="n">install</span> <span class="n">libaio</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="task03-源码分析-buildsh执行过程">task03 源码分析 build.sh执行过程</h3>
<blockquote>
<p>Check the <a href="https://oceanbase.github.io/oceanbase/toolchain/">Install toolchain</a> guide for supported OS, GLIBC version requirement, and how to install the C++ toolcha</p>
</blockquote>
<p><a href="https://oceanbase.github.io/oceanbase/toolchain/">https://oceanbase.github.io/oceanbase/toolchain/</a></p>
<p>CentOS编译</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 1. 初始化依赖</span>
./build.sh --init

<span class="c1"># 2. 选择编译模式（debug/release等）</span>
./build.sh debug --make
./build.sh release --make

</code></pre></td></tr></table>
</div>
</div><h3 id="1系统要求">1. 系统要求</h3>
<ul>
<li>
<p>CentOS 6及以上版本</p>
</li>
<li>
<p>支持的CPU架构：x86_64或aarch64</p>
</li>
</ul>
<h3 id="2-基础编译工具">2. 基础编译工具</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"># 必需的基础软件包
yum install -y \
  gcc \
  gcc-c++ \
  make \
  glibc-devel \
  libstdc++-devel \
  git \
  wget \
  perl \
  tar \
  bzip2 \
  which

</code></pre></td></tr></table>
</div>
</div><h3 id="3编译器版本要求">3. 编译器版本要求</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># GCC版本要求</span>
- 默认支持C++11标准 <span class="o">(</span>代码中 <span class="nv">CPP_STANDARD_OPTION</span><span class="o">=</span>11<span class="o">)</span>
- 如果使用-DCPP_STANDARD_20<span class="o">=</span>ON，则需要支持C++20标准的GCC版本

<span class="c1"># 推荐GCC版本</span>
- CentOS 7: GCC 4.8.5及以上
- CentOS 8: GCC 8.x及以上

</code></pre></td></tr></table>
</div>
</div><h3 id="4-系统资源要求">4. 系统资源要求</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 硬件资源</span>

- CPU: 建议4核及以上（编译会使用所有可用核心 grep -c ^processor /proc/cpuinfo）

- 内存: 建议16GB及以上

- 磁盘空间: 建议50GB及以上（用于源码、依赖和编译输出）

  

<span class="c1"># 系统配置</span>

- 最大文件打开数: <span class="nb">ulimit</span> -n <span class="m">65535</span>

- 最大用户进程数: <span class="nb">ulimit</span> -u <span class="m">65535</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="5-依赖库要求">5. 依赖库要求</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 核心依赖包</span>
yum install -y <span class="se">\
</span><span class="se"></span>  libaio-devel <span class="se">\
</span><span class="se"></span>  openssl-devel <span class="se">\
</span><span class="se"></span>  bzip2-devel <span class="se">\
</span><span class="se"></span>  zlib-devel <span class="se">\
</span><span class="se"></span>  ncurses-devel <span class="se">\
</span><span class="se"></span>  libcurl-devel <span class="se">\
</span><span class="se"></span>  readline-devel <span class="se">\
</span><span class="se"></span>  mariadb-devel <span class="se">\
</span><span class="se"></span>  boost-devel

<span class="c1"># 如果使用RPM打包还需要</span>
yum install -y <span class="se">\
</span><span class="se"></span>  rpm-build <span class="se">\
</span><span class="se"></span>  rpmlint

</code></pre></td></tr></table>
</div>
</div><h3 id="6-cmake要求">6. CMake要求</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">- 脚本会使用工具目录中的CMake: <span class="si">${</span><span class="nv">TOOLS_DIR</span><span class="si">}</span>/bin/cmake

</code></pre></td></tr></table>
</div>
</div><p>![[Pasted image 20250112163816.png]]</p>
<h3 id="流程说明">流程说明：</h3>
<h4 id="入口流程">入口流程</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">./build.sh --init
↓
main &#34;$@&#34; 。//$@ 是一个特殊变量，代表脚本运行时传递的所有命令行参数
↓
parse_args  # 设置NEED_INIT=true
↓
do_init     # 执行初始化

</code></pre></td></tr></table>
</div>
</div><h3 id="macos改造方案">MacOS改造方案</h3>
<h1 id="oceanbase-数据库知识导图">OceanBase 数据库知识导图</h1>
<p><a href="https://www.oceanbase.com/knowledge-base/oceanbase-database-1000000000324072">https://www.oceanbase.com/knowledge-base/oceanbase-database-1000000000324072</a></p>
<p><img src="https://cdn.nlark.com/yuque/0/2024/png/215144/1728394276721-9bfab5eb-d3af-4fb6-913b-f8b40b386077.png" alt=""></p>
<h2 id="参考">参考</h2>
<p>【1】  OceanBase Development Guide
<a href="https://oceanbase.github.io/oceanbase/ide-settings/">https://oceanbase.github.io/oceanbase/ide-settings/</a>
【2】 <a href="https://markdown.com.cn/extended-syntax/tables.html">https://markdown.com.cn/extended-syntax/tables.html</a>
【3】 <a href="https://llvm.org/">https://llvm.org/</a>
<a href="https://releases.llvm.org/download.html">https://releases.llvm.org/download.html</a>
<a href="https://formulae.brew.sh/formula/llvm">https://formulae.brew.sh/formula/llvm</a>
【4】 # makefile的选项CFLAGS、CPPFLAGS、LDFLAGS和LIBS的区别</p>
<ul>
<li><a href="https://www.ink-hz.cn/2021/10/10/computer-system/gcc-compile/">https://www.ink-hz.cn/2021/10/10/computer-system/gcc-compile/</a></li>
<li>深入理解计算机操作系统
【5】 流程图</li>
</ul>
<p><a href="https://snowdreams1006.github.io/write/mermaid-flow-chart.html">https://snowdreams1006.github.io/write/mermaid-flow-chart.html</a></p>
<h4 id="小贴士">小贴士</h4>
<p>一、这个技术出现的背景、初衷和要达到什么样的目标或是要解决什么样的问题</p>
<p>二、这个技术的优势和劣势分别是什么</p>
<p>三、这个技术适用的场景。任何技术都有其适用的场景</p>
<p>四、技术的组成部分和关键点。</p>
<p>五、技术的底层原理和关键实现</p>
<p>六、已有的实现和它之间的对比</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Troy</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2024-10-04 00:00
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a target="_blank" rel="license noopener" href="https://github.com/nusr/blog/blob/master/LICENSE">MIT</a></span>
  </p>
</div>
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/oceanbase/2024/08_make_ob_leader-1/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">成为ob贡献者(08):PALF: Replicated Write-Ahead Logging for Distributed Databases</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/oceanbase/2024/day6_make_ob/">
            <span class="next-text nav-default">成为ob贡献者(6):如何阅读Paxos代码</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="wangcy6/wangcy6.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:wang_cyi@163.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/wangcy6" class="iconfont icon-github" title="github"></a>
  <a href="https://wangcy6.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2017 - 
    2025
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Troy</span>
  </span>
</div>
<script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js"></script>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script><!-- NOTE: timeago.js uses the language code format like "zh_CN" (underscore and case sensitive) -->
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-138883536-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
