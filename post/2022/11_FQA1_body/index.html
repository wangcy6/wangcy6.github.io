<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>阅读与写作第一期：王者回答 - Troy的网络博客</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Troy" /><meta name="description" content="学习方法 1 2 3 4 5 6 7 8 9 10 11 12 13 ### 一、这个技术出现的背景、初衷和要达到什么样的目标或是要解决什么样的问题 ### 二、这个技术的优势和劣势分别是什" /><meta name="keywords" content="daily-interview-question, Github, c&#43;&#43;, Leetcode 题解, 后端面试" />






<meta name="generator" content="Hugo 0.83.1 with theme even" />


<link rel="canonical" href="https://wangcy6.github.io/post/2022/11_FQA1_body/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="阅读与写作第一期：王者回答" />
<meta property="og:description" content="学习方法 1 2 3 4 5 6 7 8 9 10 11 12 13 ### 一、这个技术出现的背景、初衷和要达到什么样的目标或是要解决什么样的问题 ### 二、这个技术的优势和劣势分别是什" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wangcy6.github.io/post/2022/11_FQA1_body/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-10-18T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-10-18T00:00:00&#43;00:00" />

<meta itemprop="name" content="阅读与写作第一期：王者回答">
<meta itemprop="description" content="学习方法 1 2 3 4 5 6 7 8 9 10 11 12 13 ### 一、这个技术出现的背景、初衷和要达到什么样的目标或是要解决什么样的问题 ### 二、这个技术的优势和劣势分别是什"><meta itemprop="datePublished" content="2022-10-18T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2022-10-18T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="3759">
<meta itemprop="keywords" content="60秒问答," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="阅读与写作第一期：王者回答"/>
<meta name="twitter:description" content="学习方法 1 2 3 4 5 6 7 8 9 10 11 12 13 ### 一、这个技术出现的背景、初衷和要达到什么样的目标或是要解决什么样的问题 ### 二、这个技术的优势和劣势分别是什"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Even</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">标签</li>
      </a><a href="https://github.com/wangcy6/weekly/tree/master/book">
        <li class="mobile-menu-item">阅读清单</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于我</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Even</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">标签</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://github.com/wangcy6/weekly/tree/master/book">阅读清单</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于我</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">阅读与写作第一期：王者回答</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-10-18 00:00 </span>
        
          <span class="more-meta"> 约 3759 字 </span>
          <span class="more-meta"> 预计阅读 8 分钟 </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次阅读 </span>
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#学习方法">学习方法</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#提问4100虚拟内存和物理内存怎么映射的和slap-伙伴系统-vmare啥关系">提问：4/100，虚拟内存和物理内存怎么映射的？和slap 伙伴系统 vmare啥关系？</a></li>
        <li><a href="#提问3100-valgrind-跟踪可执行程序程序---permission-deniedhttpsmaimaicnwebgossip_detailencode_ideyjhbgcioijiuzi1niisinr5cci6ikpxvcj9eyjlz2lkijoizdq1ntdhmwyzmgiwnda2nzhjmtq1mjlinduwogexzjiilcjpzci6mzeymjizmjqsinuiojq2njuxfqfpwkln4betxro8-heh_103rrnwpvthkewc7swvu-rrafromlist">提问3/100 <a href="https://maimai.cn/web/gossip_detail?encode_id=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlZ2lkIjoiZDQ1NTdhMWYzMGIwNDA2NzhjMTQ1MjliNDUwOGExZjIiLCJpZCI6MzEyMjIzMjQsInUiOjQ2NjUxfQ.FPWKLn4BETXrO8-Heh_103rrnwpVThKewc7sWVU-rrA&amp;from=list">valgrind 跟踪可执行程序程序   Permission denied</a></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#提问3100-valgrind-跟踪可执行程序程序---permission-deniedhttpsmaimaicnwebgossip_detailencode_ideyjhbgcioijiuzi1niisinr5cci6ikpxvcj9eyjlz2lkijoizdq1ntdhmwyzmgiwnda2nzhjmtq1mjlinduwogexzjiilcjpzci6mzeymjizmjqsinuiojq2njuxfqfpwkln4betxro8-heh_103rrnwpvthkewc7swvu-rrafromlist-1">提问3/100 <a href="https://maimai.cn/web/gossip_detail?encode_id=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlZ2lkIjoiZDQ1NTdhMWYzMGIwNDA2NzhjMTQ1MjliNDUwOGExZjIiLCJpZCI6MzEyMjIzMjQsInUiOjQ2NjUxfQ.FPWKLn4BETXrO8-Heh_103rrnwpVThKewc7sWVU-rrA&amp;from=list">valgrind 跟踪可执行程序程序   Permission denied</a></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#提问1100-c-全局静态对象-什么时候初始化">提问1/100 c++ 全局静态对象 什么时候初始化</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#提问-5100daemon守护进程httpsblogcsdnnetxuleilxarticledetails8258798">提问 5/100：<a href="https://blog.csdn.net/xuleilx/article/details/8258798">daemon(守护进程)</a></a></li>
        <li><a href="#题目3100-内存很大找不到那里是">题目3/100 内存很大，找不到那里是</a></li>
        <li><a href="#heading"></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#提问2100-rpm管理">提问2/100 rpm管理</a></li>
        <li><a href="#提问1-keeplive">提问1 keeplive</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
  <div class="post-outdated">
    <div class="hint">
      <p>【注意】最后更新于 <span class="timeago" datetime="2022-10-18T00:00:00" title="October 18, 2022">October 18, 2022</span>，文中内容可能已过时，请谨慎使用。</p>
    </div>
  </div>
    <div class="post-content">
      <h3 id="学习方法">学习方法</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">

### 一、这个技术出现的背景、初衷和要达到什么样的目标或是要解决什么样的问题

### 二、这个技术的优势和劣势分别是什么 

### 三、这个技术适用的场景。任何技术都有其适用的场景，离开了这个场景

### 四、技术的组成部分和关键点。

### 五、技术的底层原理和关键实现

### 六、已有的实现和它之间的对比
</code></pre></td></tr></table>
</div>
</div><ul>
<li>步骤</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">1. 阅读(输入：三天,万句   输出 笔记摘要就哪里，但是自己看不懂，别人看不懂 ) 

2. 发现问题（输入：技术文档 30分钟 百句，输出 ：一大堆东西不无法语言描述，反正就是他，自己回答不清楚，别人听不清楚）

3. 整理问题（输入：5分钟 10句 技术文档  输出：核心根本无法理解，至少说到重点，不管别人听不懂，至少自己理解极限了）

4. 回答问题（输入：60秒,2句 技术语言  输出：一个视频）
</code></pre></td></tr></table>
</div>
</div><ul>
<li>输出结果</li>
</ul>
<ol>
<li>http://localhost:1313/post/2022/11_FQA1_body/ 【回答】</li>
<li>http://localhost:1313/post/2022/06_ask_1 【提问】</li>
</ol>
<h1 id="fqa">FQA</h1>
<h3 id="提问4100虚拟内存和物理内存怎么映射的和slap-伙伴系统-vmare啥关系">提问：4/100，虚拟内存和物理内存怎么映射的？和slap 伙伴系统 vmare啥关系？</h3>
<p><img src="assets/image-20221102101732096.png" alt="dr"></p>
<p>提问2/100：<a href="https://maimai.cn/web/gossip_detail?encode_id=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlZ2lkIjoiZTE1OTg3NTIzZTQ4NGZhN2IyYjViYWFmZDczY2YwNWQiLCJpZCI6MzEyMTczNTAsInUiOjQ2NjUxfQ.gH0qE4ziR-zcar_qTHMSnWyph2PriADQkzdmplm2Djs&amp;from=list">slabtop 查看 task_struct越来越大，这个怎么回收？</a></p>
<h3 id="提问3100-valgrind-跟踪可执行程序程序---permission-deniedhttpsmaimaicnwebgossip_detailencode_ideyjhbgcioijiuzi1niisinr5cci6ikpxvcj9eyjlz2lkijoizdq1ntdhmwyzmgiwnda2nzhjmtq1mjlinduwogexzjiilcjpzci6mzeymjizmjqsinuiojq2njuxfqfpwkln4betxro8-heh_103rrnwpvthkewc7swvu-rrafromlist">提问3/100 <a href="https://maimai.cn/web/gossip_detail?encode_id=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlZ2lkIjoiZDQ1NTdhMWYzMGIwNDA2NzhjMTQ1MjliNDUwOGExZjIiLCJpZCI6MzEyMjIzMjQsInUiOjQ2NjUxfQ.FPWKLn4BETXrO8-Heh_103rrnwpVThKewc7sWVU-rrA&amp;from=list">valgrind 跟踪可执行程序程序   Permission denied</a></h3>
<p>valgrind &ndash;tool=memcheck  /usr/bin/beegfs-ctl
valgrind: /usr/bin/beegfs-ctl: Permission denied
root用户怎么处理</p>
<h1 id="答案">答案</h1>
<h1 id="tool">tool</h1>
<h3 id="提问3100-valgrind-跟踪可执行程序程序---permission-deniedhttpsmaimaicnwebgossip_detailencode_ideyjhbgcioijiuzi1niisinr5cci6ikpxvcj9eyjlz2lkijoizdq1ntdhmwyzmgiwnda2nzhjmtq1mjlinduwogexzjiilcjpzci6mzeymjizmjqsinuiojq2njuxfqfpwkln4betxro8-heh_103rrnwpvthkewc7swvu-rrafromlist-1">提问3/100 <a href="https://maimai.cn/web/gossip_detail?encode_id=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlZ2lkIjoiZDQ1NTdhMWYzMGIwNDA2NzhjMTQ1MjliNDUwOGExZjIiLCJpZCI6MzEyMjIzMjQsInUiOjQ2NjUxfQ.FPWKLn4BETXrO8-Heh_103rrnwpVThKewc7sWVU-rrA&amp;from=list">valgrind 跟踪可执行程序程序   Permission denied</a></h3>
<p>valgrind &ndash;tool=memcheck  /usr/bin/beegfs-ctl
valgrind: /usr/bin/beegfs-ctl: Permission denied
root用户怎么处理</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sudo chown 0:0 ./beegfs-ctl
sudo chown 0:0 /usr/bin/beegfs-ctl
sudo chown 0:0  /bin/sh

valgrind --tool=memcheck  --log-file=&#34;dump&#34; --trace-children=yes --dsymutil=yes --leak-check=full --show-leak-kinds=all ./beegfs-ctl --migrate --storagepoolid=2 --destinationpoolid=1 /mnt/beegfs/big/case7/vdb.1_2.dir/vdb.2_4.dir/vdb_f272664.file】

/var/log/local/tool/Python-3.6.8
valgrind --tool=memcheck --log-file=&#34;dump1&#34; --trace-children=yes --dsymutil=yes --leak-check=full --show-leak-kinds=all --suppressions=/var/log/local/tool/Python-3.6.8/Misc/valgrind-python.supp /usr/local/python/bin/python3.6 ./test.py


valgrind --tool=memcheck  --log-file=&#34;dump&#34; --trace-children=yes --dsymutil=yes --leak-check=full --show-leak-kinds=all --suppressions=/var/log/local/tool/Python-3.6.8/Misc/valgrind-python.supp /usr/local/python/bin/python3.6 /opt/beegfs/move/src/beegfs_test.py

</code></pre></td></tr></table>
</div>
</div><h1 id="c">c++</h1>
<h3 id="提问1100-c-全局静态对象-什么时候初始化">提问1/100 c++ 全局静态对象 什么时候初始化</h3>
<ul>
<li>
<p>对于 <em>C</em> 语言的全局和静态变量，不管是否被初始化，其内存空间都是全局的；如果初始化，那么初始化发生在任何代码执行之前，属于编译期初始化。</p>
</li>
<li>
<p>标准规定：全局或静态对象当且仅当对象首次用到时才进行构造，并通过 <em>atexit()</em> 来管理对象的生命期，在程序结束之后（如调用 <em>exit</em> ， <em>main</em> ），按 <em>FILO</em> 顺序调用相应的析构操作</p>
</li>
<li>
<p>dynamic initialization
这种初始化针对的是需要调用构造函数才能完成的初始化。这种初始化会在main函数执行前由运行时库调用对应的代码进行初始化。</p>
</li>
<li>
<p>全局变量无疑要在main函数开始前执行完成，但可细分为在编译时和在运行时初始化</p>
</li>
<li>
<p>但是在C++语言中，由于构造函数不是常量表达式，因此无法用构造函数给全局对象赋初值。</p>
<p>因此才有了编译器自动生成函数用来对全局对象赋初值，注意，这个动作是在程序运行期执行的，而不是类对象的全局变量（如int，char*等类型）的初始化由于可以使用常量表达式，因此在编译器就可以完成赋值动作，编译完后该变量的值已经被赋值好了。</p>
<p>最后，用来给全局对象赋初值和析构的函数在main函数内的一开始以及退出前被调用，如</p>
</li>
</ul>
<h1 id="lliunx">Lliunx</h1>
<h3 id="提问-5100daemon守护进程httpsblogcsdnnetxuleilxarticledetails8258798">提问 5/100：<a href="https://blog.csdn.net/xuleilx/article/details/8258798">daemon(守护进程)</a></h3>
<ul>
<li>，每一个从此终端开始运行的进程都会依附于这个终端，这个终端就称为这些进程的控制终端，当控制终端被关闭时，相应的进程都会自动关闭。但是守护进程却能够突破这种限制，它从被执行开始运转，直到整个系统关闭时才退出。</li>
<li><a href="https://blog.csdn.net/woxiaohahaa/article/details/53487602">https://blog.csdn.net/woxiaohahaa/article/details/53487602</a></li>
<li><a href="https://blog.csdn.net/Kobe__Bryant__/article/details/120220117#:~:text=linux%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%20%E5%92%8C%E8%BF%9B%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB%20%5Bps%20-exj%20pstree%5D%201%20PID%20%28Process,S%20sleeping%20%E7%9D%A1%E7%9C%A0%E7%8A%B6%E6%80%81%20%28%E5%8F%AF%E4%BB%A5%E8%A2%AB%E7%B3%BB%E7%BB%9F%E5%94%A4%E9%86%92%29%20T%20stop%20%E5%81%9C%E6%AD%A2%E7%8A%B6%E6%80%81%20%5D"><strong>pstree</strong></a></li>
<li>pd -exj</li>
<li></li>
</ul>
<p>提问4/200：判断系统有没有重启 ？</p>
<ul>
<li>uptime -s</li>
</ul>
<p>-s, &ndash;since
system up since, in yyyy-mm-dd HH:MM:SS format</p>
<ul>
<li>date -s &ldquo;2019-06-25 20:13:00&rdquo;</li>
</ul>
<h3 id="题目3100-内存很大找不到那里是">题目3/100 内存很大，找不到那里是</h3>
<p>free查看内存占用很多（cache除外），但是top查看进程占用内存很小
业务程序是：python调用调用另外一个程序执行，初步这个地方出问题了。大量请求
该怎么查看呢slabtop 一个task占用很多内存</p>
<h3 id="heading"></h3>
<p>：perf record  -F 99  -g -e kmem:kmem_cache_alloc_node  &ndash; sleep 30</p>
<p>查资料</p>
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/s2-proc-meminfo">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/deployment_guide/s2-proc-meminfo</a></p>
</li>
<li>
<p>/proc/meminfo 内存参数内核分配/释放过程介绍</p>
</li>
<li>
<h1 id="原创systemtap脚本分析系统中dentry-slab占用过高问题">[原创]systemtap脚本分析系统中dentry SLAB占用过高问题</h1>
</li>
<li>
<p><a href="https://cn.pingcap.com/blog/flame-graph">https://cn.pingcap.com/blog/flame-graph</a> 工欲性能调优，必先利其器（2）- 火焰图</p>
</li>
<li>
<p>动态追踪技术漫谈 <a href="https://blog.openresty.com.cn/cn/dynamic-tracing/">https://blog.openresty.com.cn/cn/dynamic-tracing/</a></p>
</li>
<li>
<p>发生即看见，一切可回溯 | TiDB 故障诊断与性能排查探讨</p>
</li>
</ul>
<p>​</p>
<ul>
<li><a href="https://blog.csdn.net/Darlingqiang/article/details/118914428">https://blog.csdn.net/Darlingqiang/article/details/118914428</a></li>
<li><a href="https://pythonextensionpatterns.readthedocs.io/en/latest/debugging/valgrind.html">https://pythonextensionpatterns.readthedocs.io/en/latest/debugging/valgrind.html</a></li>
<li><a href="https://www.semicolonworld.com/question/56034/how-to-use-valgrind-with-python">https://www.semicolonworld.com/question/56034/how-to-use-valgrind-with-python</a></li>
</ul>
<p>输出：</p>
<p>第三次</p>
<ul>
<li>
<p><a href="https://blog.csdn.net/sy4331/article/details/120241025">https://blog.csdn.net/sy4331/article/details/120241025</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/sy4331/article/details/126010513">https://blog.csdn.net/sy4331/article/details/126010513</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/sy4331/article/details/126010513">https://blog.csdn.net/sy4331/article/details/126010513</a></p>
</li>
<li>
<p><a href="https://hammertux.github.io/slab-allocator">https://hammertux.github.io/slab-allocator</a></p>
</li>
<li>
<p><a href="https://www.cnblogs.com/sunshine-blog/p/11905491.html">Linux系统性能测试工具（二）——内存压力测试工具memtester</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/s1421578048/article/details/104262751/">https://blog.csdn.net/s1421578048/article/details/104262751/</a></p>
</li>
<li>
<h1 id="详解slab机制">详解slab机制</h1>
</li>
</ul>
<p><a href="https://www.cnblogs.com/zafu/p/10042099.html">https://www.cnblogs.com/zafu/p/10042099.html</a></p>
<p>SLAB_RECLAIM_ACCOUNT</p>
<p><a href="https://github.com/brendangregg/perf-tools">https://github.com/brendangregg/perf-tools</a></p>
<p><a href="https://chegva.com/3464.html">https://chegva.com/3464.html</a></p>
<p>如何排查Linux slab_unreclaimable内存占用高的原因？</p>
<ul>
<li>
<p><a href="https://blog.csdn.net/liuxiao723846/article/details/72625394">https://blog.csdn.net/liuxiao723846/article/details/72625394</a></p>
</li>
<li>
<p><a href="https://help.aliyun.com/document_detail/316787.html">https://help.aliyun.com/document_detail/316787.html</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/solutions/6123251">https://access.redhat.com/solutions/6123251</a></p>
</li>
<li>
<p><a href="https://serverfault.com/questions/877257/why-cant-my-linux-kernel-reclaim-its-slab-memory">https://serverfault.com/questions/877257/why-cant-my-linux-kernel-reclaim-its-slab-memory</a></p>
</li>
<li>
<p><a href="https://www.jianshu.com/p/a7af7c29c9e2">https://www.jianshu.com/p/a7af7c29c9e2</a></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">ps aux | awk &#39;{mem += $6} END {print mem/1024/1024}&#39;
less /proc/meminfo  |grep ^S
cat /proc/slabinfo |awk &#39;{printf &#34;%7i MiB : %s\n&#34;,$6*$(NF-1)/256,$1}&#39;|sort -nk 1 -r|head -5
cat /proc/slabinfo | grep -i cred_jar
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>见buffer_head描述的是磁盘block和内存<a href="https://so.csdn.net/so/search?q=buffer&amp;spm=1001.2101.3001.7020">buffer</a>之间的映射关系。</p>
<p><a href="https://blog.csdn.net/u010039418/article/details/116034421">https://blog.csdn.net/u010039418/article/details/116034421</a></p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">perf record -e probe_tikv:malloc -F 99 -p tikv_pid -g -- sleep 10
perf script &gt; out.perf
/opt/FlameGraph/stackcollapse-perf.pl out.perf &gt; out.folded
/opt/FlameGraph/flamegraph.pl  --colors=mem out.folded &gt; mem.svg

sudo perf record -e cpu-clock -g -p 1648249


perf record -a -e kmem:kmalloc --filter &#39;bytes_alloc == 192&#39; -e kmem:kfree --filter &#39; ptr != 0&#39; sleep 200

perf record -a -e kmem:kmalloc --filter &#39;bytes_alloc == 192&#39; -e kmem:kfree --filter &#39; ptr != 0&#39; sleep 200


perf script -i perf.data &gt; perf.unfold


./FlameGraph/stackcollapse-perf.pl perf.unfold &gt; perf.folded

./FlameGraph/flamegraph.pl perf.folded &gt; perf_job_salve_2.svg

https://cn.pingcap.com/blog/flame-graph


</code></pre></td></tr></table>
</div>
</div><ol>
<li>火焰图（Flame Graph）是由 Linux 性能优化大师 Brendan Gregg 发明的</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">perf record -F 99 -p tikv_pid -g -- sleep 60
perf script &gt; out.perf
</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Valgrind</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">https://pythonextensionpatterns.readthedocs.io/en/latest/debugging/valgrind.html

https://pythonextensionpatterns.readthedocs.io/en/latest/debugging/leak_newrefs_vg.html#leaked-new-references-valgrind-label

https://github.com/vpython/visual/blob/master/valgrind-python.supp
As per recommendation from Readme.valgrind I did the following.

1) Downloaded the python source with

sudo apt-get build-dep python2.7
apt-get source python2.7
2) Applied the code patch, i.e. &#34;Uncomment Py_USING_MEMORY_DEBUGGER in Objects/obmalloc.c&#34;.

3) Applied the suppression patch, i.e. &#34;Uncomment the lines in Misc/valgrind-python.supp that suppress the warnings for PyObject_Free and PyObject_Realloc&#34;

4) Compiled python with

--enable-framework

Installs it in /Library/Frameworks/Python.framework/Versions/

--with-pydebug

Debug build of Python. See Misc/SpecialBuilds.txt

--without-pymalloc

With Valgrind support Misc/README.valgrind



./configure --prefix=/home/dejan/workspace/python --without-pymalloc
make -j4 install


If you don&#39;t want to read about the details of using Valgrind, there
are still two things you must do to suppress the warnings.  First,
you must use a suppressions file.  One is supplied in
Misc/valgrind-python.supp.  Second, you must do one of the following:

  * Uncomment Py_USING_MEMORY_DEBUGGER in Objects/obmalloc.c,
    then rebuild Python
  * Uncomment the lines in Misc/valgrind-python.supp that
    suppress the warnings for PyObject_Free and PyObject_Realloc

/usr/local/pytho

Valgrind包括如下一些工具：

Memcheck。这是valgrind应用最广泛的工具，一个重量级的内存检查器，能够发现开发中绝大多数内存错误使用情况，比如：使用未初始化的内存，使用已经释放了的内存，内存访问越界等。这也是本文将重点介绍的部分。
Callgrind。它主要用来检查程序中函数调用过程中出现的问题。
Cachegrind。它主要用来检查程序中缓存使用出现的问题。
Helgrind。它主要用来检查多线程程序中出现的竞争问题。
Massif。它主要用来检查程序中堆栈使用中出现的问题。
Extension。可以利用core提供的功能，自己编写特定的内存调试工具
————————————————
版权声明：本文为CSDN博主「sishuihuahua」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/sishuihuahua/article/details/85930419

https://www.gnu.org/software/automake/
yum install autoconf
yum install automake
yum install libtool
./autogen.sh

git clone https://sourceware.org/git/valgrind.git
cd valgrind
cd valgrind
./autogen.sh
./configure
make
make install

./configure --with-pydebug --without-pymalloc --with-valgrind

/usr/share/doc/platform-python-devel

valgrind --tool=memcheck --trace-children=yes --dsymutil=yes --leak-check=full --show-leak-kinds=all --suppressions=/var/log/local/tool/Python-3.6.8/Misc/valgrind-python.supp /usr/local/python/bin/python3.6 /opt/beegfs/move/src/beegfs_test.py


Linux Perf 性能分析工具及火焰图浅析
Perf 是内置于 Linux 内核源码树中的性能剖析（profiling）工具、
https://zhuanlan.zhihu.com/p/54276509
https://phoenixnap.com/kb/linux-perf

perf stat对全局性能进行统计；
perf top可以实时查看当前系统进程函数占用率情况；
pref record记录信息到perf.data；
perf report生成报告；
1，首先使用 perf record 命令记录进程的 CPU 使用情况
命令：

sudo perf record -e cpu-clock -g -p 1648249


2. 使用 perf script 工具对 perf.data 进行解析
命令：sudo 

perf script -i perf.data &gt; perf.unfold

3. 使用 Flame Graph 工具将 perf.unfold 中的符号折叠 //生成脚本文件
yum install perl


./FlameGraph/stackcollapse-perf.pl perf.unfold &gt; perf.folded


4. 使用 Flame Graph 工具将 perf.folded 生成 svg 火焰图
命令：

./FlameGraph/flamegraph.pl perf.folded &gt; perf_job_salve_1.svg 

//执行完成后生成perf.svg图片，可以下载到本地，用浏览器打开 perf.svg


命令：perf script | ./FlameGraph/stackcollapse-perf.pl | ./FlameGraph/flamegraph.pl &gt; out.svg

火焰图插件下载地址：
https://github.com/brendangregg/FlameGraph
快捷命令：
git clone https://github.com/brendangregg/FlameGraph.git
火焰图原文翻译：
https://zhuanlan.zhihu.com/p/73385693

软件的性能分析，往往需要查看 CPU 耗时，了解瓶颈在哪里
http://www.ruanyifeng.com/blog/2017/09/flame-graph.html

致命报错：想生成火焰图，但是老是抛出错误：ERROR: No stack counts found，could not generate flame graph: exit status 2。
弄了很久，以为是 perf 没装，但是装了也不行，然后发现必须在访问程序时，火焰图才能生成


# -d 表示高亮变化的字段
# -A 表示仅显示Normal行以及之后的15行输出
$ watch -d grep -A 15 &#39;Normal&#39; /proc/zoneinfo
Node 0, zone   Normal
  pages free     21328
        min      14896
        low      18620
        high     22344
        spanned  1835008
        present  1835008
        managed  1796710
        protection: (0, 0, 0, 0, 0)
      nr_free_pages 21328
      nr_zone_inactive_anon 79776
      nr_zone_active_anon 206854
      nr_zone_inactive_file 918561
      nr_zone_active_file 496695
      nr_zone_unevictable 2251
      nr_zone_write_pending 0
      
https://help.aliyun.com/document_detail/316787.html
</code></pre></td></tr></table>
</div>
</div><h3 id="提问2100-rpm管理">提问2/100 rpm管理</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">https</span><span class="p">:</span><span class="c1">//www.tecmint.com/20-practical-examples-of-rpm-commands-in-linux/
</span><span class="c1"></span>
<span class="nx">rpm</span> <span class="o">-</span><span class="nx">qpR</span> <span class="nx">beegfs</span><span class="o">-</span><span class="nx">move</span><span class="o">-</span><span class="nx">utils</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">1.</span><span class="nx">el8</span><span class="p">.</span><span class="nx">noarch</span><span class="p">.</span><span class="nx">rpm</span>
<span class="o">-</span><span class="nx">q</span> <span class="p">:</span> <span class="nx">Query</span> <span class="nx">a</span> <span class="kn">package</span>
<span class="o">-</span><span class="nx">p</span> <span class="p">:</span> <span class="nx">List</span> <span class="nx">capabilities</span> <span class="nx">this</span> <span class="kn">package</span> <span class="nx">provides</span><span class="p">.</span>
<span class="o">-</span><span class="nx">R</span><span class="p">:</span> <span class="nx">List</span> <span class="nx">capabilities</span> <span class="nx">on</span> <span class="nx">which</span> <span class="nx">this</span> <span class="kn">package</span> <span class="nx">depends</span><span class="p">..</span>

<span class="nx">How</span> <span class="nx">to</span> <span class="nx">List</span> <span class="nx">all</span> <span class="nx">files</span> <span class="nx">of</span> <span class="nx">an</span> <span class="nx">installed</span> <span class="nx">RPM</span> <span class="kn">package</span>
<span class="nx">rpm</span> <span class="o">-</span><span class="nx">ql</span> <span class="nx">beegfs</span><span class="o">-</span><span class="nx">move</span><span class="o">-</span><span class="nx">utils</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">1.</span><span class="nx">el8</span><span class="p">.</span><span class="nx">noarch</span><span class="p">.</span><span class="nx">rpm</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="提问1-keeplive">提问1 keeplive</h3>
<blockquote>
<p>分析：</p>
</blockquote>
<p>sysctl -a|grep tcp_keepalive</p>
<p>net.ipv4.tcp_keepalive_intvl = 75</p>
<p>当探测没有确认时，重新发送探测的频度。缺省是75秒。</p>
<p>net.ipv4.tcp_keepalive_probes = 9</p>
<p>在认定连接失效之前，发送多少个TCP的keepalive探测包。缺省值是9。</p>
<p>这个值乘以tcp_keepalive_intvl之后决定了，一个连接发送了keepalive之后可以有多少时间没有回应</p>
<p>net.ipv4.tcp_keepalive_time = 1200
当keepalive起用的时候，TCP发送keepalive消息的频度。缺省是2小时</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
# # The default value:
# cat /proc/sys/net/ipv4/tcp_congestion_control
cubic
# cat /proc/sys/net/ipv4/tcp_keepalive_time
7200
# cat /proc/sys/net/ipv4/tcp_keepalive_intvl
75
# cat /proc/sys/net/ipv4/tcp_keepalive_probes
9
 
## To update the value:

echo 30 &gt; /proc/sys/net/ipv4/tcp_keepalive_time
echo 10 &gt; /proc/sys/net/ipv4/tcp_keepalive_intvl
echo 6 &gt; /proc/sys/net/ipv4/tcp_keepalive_probes


在Linux中我们可以通过修改 /etc/sysctl.conf 的全局配置：

net.ipv4.tcp_keepalive_time=30
net.ipv4.tcp_keepalive_intvl=10
net.ipv4.tcp_keepalive_probes=6

</code></pre></td></tr></table>
</div>
</div><p>添加上面的配置后输入 sysctl -p 使其生效</p>
<p>你可以使用  sysctl -a | grep keepalive 命令来查看当前的默认配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
fs.aio-max-nr=1048576
net.ipv4.tcp_keepalive_time=30
net.ipv4.tcp_keepalive_intvl=10
net.ipv4.tcp_keepalive_probes=6


# Controls the default maxmimum size of a mesage queue
kernel.msgmnb = 65536

# Controls the maximum size of a message, in bytes
kernel.msgmax = 65536

# Controls the maximum shared segment size, in bytes
kernel.shmmax = 68719476736
# Controls the maximum number of shared memory segments, in pages
kernel.shmall = 4294967296
#Lashou WEB
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_max_syn_backlog = 8192
net.ipv4.tcp_max_tw_buckets = 10000
net.ipv4.tcp_max_syn_backlog = 65535
net.core.netdev_max_backlog = 32768
net.core.somaxconn = 32768
net.ipv4.tcp_synack_retries = 2
net.ipv4.tcp_syn_retries = 2
net.ipv4.tcp_timestamps = 0
net.ipv4.tcp_fin_timeout = 10
net.ipv4.ipfrag_time = 15
net.ipv4.ip_local_port_range = 1024  65535
vm.overcommit_memory=1
# add config
kernel.shmall = 2097152
kernel.shmmax = 2147483648
kernel.shmmni = 4096
kernel.sem = 250        32000   100      128
net.ipv4.tcp_max_syn_backlog = 65536
net.core.netdev_max_backlog = 32768
net.core.somaxconn = 32768


net.core.wmem_default = 8388608
net.core.rmem_default = 8388608
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_timestamps = 0
net.ipv4.tcp_synack_retries = 2
net.ipv4.tcp_syn_retries = 2


net.ipv4.tcp_mem = 94500000 915000000 927000000
net.ipv4.tcp_max_orphans = 3276800
net.ipv4.ip_local_port_range = 1024 65535
fs.file-max = 655360

net.ipv4.tcp_keepalive_time=30
net.ipv4.tcp_keepalive_intvl=10
net.ipv4.tcp_keepalive_probes=6

</code></pre></td></tr></table>
</div>
</div><ul>
<li>打开最大文件个数</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">echo &#39;fs.aio-max-nr=1048576&#39; | sudo tee /etc/sysctl.conf

sysctl -p

echo -e &#34;root soft nofile 655350\nroot hard nofile 655350\n* soft nofile 655350\n* hard nofile 655350&#34;&gt;&gt; /etc/security/limits.conf
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>tcp backlog</p>
<p>阅读linux tcp socket 请求队列大小参数 backlog 简介</p>
<p><a href="https://zhuanlan.zhihu.com/p/104874605">详解socket中的backlog 参数</a></p>
</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/2792101-e436bf34b4dbe79a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/657/format/webp" alt=""></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Troy</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2022-10-18 00:00
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a target="_blank" rel="license noopener" href="https://github.com/nusr/blog/blob/master/LICENSE">MIT</a></span>
  </p>
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/60%E7%A7%92%E9%97%AE%E7%AD%94/">60秒问答</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022/10_2022_10_13_how_to-use_emacs/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">从青铜到王者系列1：emacs入门教程</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/2022/12-how_to_read_liunx/">
            <span class="next-text nav-default">阅读与写作第一期：王者回答</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="wangcy6/wangcy6.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:wang_cyi@163.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/wangcy6" class="iconfont icon-github" title="github"></a>
  <a href="https://wangcy6.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> 本站总访问量 <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 次 </span>
      <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> 本站总访客数 <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> 人 </span>
  </div>

  <span class="copyright-year">
    &copy; 
    2017 - 
    2024
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Troy</span>
  </span>
</div>
<script src="https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js"></script>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.min.js" integrity="sha256-jwCP0NAdCBloaIWTWHmW4i3snUNMHUNO+jr9rYd2iOI=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/timeago.js@3.0.2/dist/timeago.locales.min.js" integrity="sha256-ZwofwC1Lf/faQCzN7nZtfijVV6hSwxjQMwXL4gn9qU8=" crossorigin="anonymous"></script>
  <script><!-- NOTE: timeago.js uses the language code format like "zh_CN" (underscore and case sensitive) -->
    var languageCode = "zh-cn".replace(/-/g, '_').replace(/_(.*)/, function ($0, $1) {return $0.replace($1, $1.toUpperCase());});
    timeago().render(document.querySelectorAll('.timeago'), languageCode);
    timeago.cancel();  
  </script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-138883536-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
